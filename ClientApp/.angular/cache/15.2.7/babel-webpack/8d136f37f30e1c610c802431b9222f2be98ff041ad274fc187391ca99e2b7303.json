{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"./storage.service\";\nimport * as i2 from \"@angular/common\";\nfunction AppComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 47)(1, \"p\", 48)(2, \"strong\");\n    i0.ɵɵtext(3, \"Selected File:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 36);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.selectedFile.name, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Size: \", (ctx_r0.selectedFile.size / 1024 / 1024).toFixed(2), \" MB\");\n  }\n}\nfunction AppComponent_tr_58_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 49)(1, \"td\")(2, \"div\", 50);\n    i0.ɵɵelement(3, \"i\", 51);\n    i0.ɵɵelementStart(4, \"span\", 52);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(6, \"td\")(7, \"code\", 36);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"td\")(10, \"span\", 53);\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"number\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"td\")(14, \"small\", 54);\n    i0.ɵɵtext(15);\n    i0.ɵɵpipe(16, \"date\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"td\", 18)(18, \"div\", 55)(19, \"button\", 56);\n    i0.ɵɵlistener(\"click\", function AppComponent_tr_58_Template_button_click_19_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const file_r6 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.downloadFile(file_r6.uuidFileName));\n    });\n    i0.ɵɵelement(20, \"i\", 57);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"button\", 58);\n    i0.ɵɵlistener(\"click\", function AppComponent_tr_58_Template_button_click_21_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const file_r6 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.deleteFile(file_r6.uuidFileName));\n    });\n    i0.ɵɵelement(22, \"i\", 59);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const file_r6 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(file_r6.originalFileName);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(file_r6.uuidFileName);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(12, 4, file_r6.size), \" bytes\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(16, 6, file_r6.uploadDate, \"short\"));\n  }\n}\nfunction AppComponent_div_59_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 60);\n    i0.ɵɵelement(1, \"i\", 61);\n    i0.ɵɵelementStart(2, \"p\", 62);\n    i0.ɵɵtext(3, \"No files found in storage\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 54);\n    i0.ɵɵtext(5, \"Upload your first file to get started!\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AppComponent_tr_80_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 49)(1, \"td\")(2, \"div\", 50);\n    i0.ɵɵelement(3, \"i\", 63);\n    i0.ɵɵelementStart(4, \"span\", 52);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"span\", 64);\n    i0.ɵɵtext(7, \"New\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(8, \"td\")(9, \"code\", 36);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"td\", 18)(12, \"div\", 55)(13, \"button\", 56);\n    i0.ɵɵlistener(\"click\", function AppComponent_tr_80_Template_button_click_13_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const file_r10 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.downloadFile(file_r10.uuidFileName));\n    });\n    i0.ɵɵelement(14, \"i\", 57);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"button\", 58);\n    i0.ɵɵlistener(\"click\", function AppComponent_tr_80_Template_button_click_15_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const file_r10 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.deleteFile(file_r10.uuidFileName));\n    });\n    i0.ɵɵelement(16, \"i\", 59);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const file_r10 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(file_r10.originalFileName);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(file_r10.uuidFileName);\n  }\n}\nfunction AppComponent_div_81_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 65);\n    i0.ɵɵelement(1, \"i\", 66);\n    i0.ɵɵelementStart(2, \"p\", 54);\n    i0.ɵɵtext(3, \"No files uploaded in this session\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AppComponent_tr_99_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 49)(1, \"td\")(2, \"div\", 50);\n    i0.ɵɵelement(3, \"i\", 67);\n    i0.ɵɵelementStart(4, \"code\", 54);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(6, \"td\", 18)(7, \"div\", 55)(8, \"button\", 56);\n    i0.ɵɵlistener(\"click\", function AppComponent_tr_99_Template_button_click_8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r16);\n      const file_r14 = restoredCtx.$implicit;\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.downloadFile(file_r14.name));\n    });\n    i0.ɵɵelement(9, \"i\", 57);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 58);\n    i0.ɵɵlistener(\"click\", function AppComponent_tr_99_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r16);\n      const file_r14 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.deleteFile(file_r14.name));\n    });\n    i0.ɵɵelement(11, \"i\", 59);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const file_r14 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(file_r14.name);\n  }\n}\nexport class AppComponent {\n  constructor(storageService) {\n    this.storageService = storageService;\n    this.title = 'app';\n    this.files = [];\n    this.filesWithMetadata = []; // 帶有原始檔案名稱的檔案列表\n    this.selectedFile = null;\n    this.uploadedFiles = []; // 儲存上傳的檔案資訊\n    this.sortDescending = true; // 排序方向：true = 降序（最新在前），false = 升序（最舊在前）\n    // UI state management\n    this.isUploading = false;\n    this.uploadProgress = 0;\n    this.isLoading = false;\n  }\n  ngOnInit() {\n    this.loadFiles();\n  }\n  loadFiles() {\n    this.isLoading = true;\n    // 載入原始的檔案列表（舊版 API）\n    this.storageService.getFileList().subscribe(data => {\n      this.files = data.items || [];\n    });\n    // 載入帶有元數據的檔案列表（新版 API）\n    this.storageService.getFileListWithMetadata().subscribe(data => {\n      this.filesWithMetadata = data;\n      this.sortFilesByDate();\n      this.isLoading = false;\n    });\n  }\n  sortFilesByDate() {\n    this.filesWithMetadata.sort((a, b) => {\n      const dateA = new Date(a.uploadDate).getTime();\n      const dateB = new Date(b.uploadDate).getTime();\n      return this.sortDescending ? dateB - dateA : dateA - dateB;\n    });\n  }\n  toggleSortOrder() {\n    this.sortDescending = !this.sortDescending;\n    this.sortFilesByDate();\n  }\n  onFileSelected(event) {\n    this.selectedFile = event.target.files[0];\n  }\n  onUpload() {\n    if (this.selectedFile) {\n      this.isUploading = true;\n      this.storageService.uploadFile(this.selectedFile).subscribe(response => {\n        // 將上傳的檔案資訊加入到列表中\n        this.uploadedFiles.push({\n          uuidFileName: response.uuidFileName,\n          originalFileName: response.originalFileName\n        });\n        this.loadFiles();\n        this.selectedFile = null;\n        this.isUploading = false;\n        // Reset file input\n        const fileInput = document.getElementById('fileInput');\n        if (fileInput) {\n          fileInput.value = '';\n        }\n      }, error => {\n        this.isUploading = false;\n        console.error('Upload failed:', error);\n      });\n    }\n  }\n  downloadFile(uuidFileName) {\n    // 使用簡化的下載方法，直接開啟下載連結\n    this.storageService.downloadFile(uuidFileName);\n  }\n  // 如果需要更複雜的下載處理，可以使用這個方法\n  downloadFileAsBlob(uuidFileName) {\n    this.storageService.downloadFileAsBlob(uuidFileName).subscribe(blob => {\n      const a = document.createElement('a');\n      const objectUrl = URL.createObjectURL(blob);\n      a.href = objectUrl;\n      a.download = `downloaded_${uuidFileName}`; // 使用 UUID 作為預設檔案名稱\n      a.click();\n      URL.revokeObjectURL(objectUrl);\n    });\n  }\n  deleteFile(uuidFileName) {\n    this.storageService.deleteFile(uuidFileName).subscribe(() => {\n      // 從本地列表中移除已刪除的檔案\n      this.uploadedFiles = this.uploadedFiles.filter(f => f.uuidFileName !== uuidFileName);\n      this.loadFiles();\n    });\n  }\n}\nAppComponent.ɵfac = function AppComponent_Factory(t) {\n  return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.StorageService));\n};\nAppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AppComponent,\n  selectors: [[\"app-root\"]],\n  decls: 100,\n  vars: 13,\n  consts: [[1, \"bg-light\"], [1, \"container\", \"py-4\"], [1, \"text-center\", \"mb-5\"], [1, \"display-4\", \"text-primary\", \"mb-2\"], [1, \"fas\", \"fa-cloud-upload-alt\", \"me-3\"], [1, \"lead\", \"text-muted\"], [1, \"card\", \"shadow-sm\", \"mb-4\", \"border-0\"], [1, \"card-header\", \"bg-gradient-primary\", \"text-white\"], [1, \"card-title\", \"mb-0\"], [1, \"fas\", \"fa-upload\", \"me-2\"], [1, \"card-body\", \"p-4\"], [1, \"upload-area\", \"border-2\", \"border-dashed\", \"border-primary\", \"rounded\", \"p-4\", \"text-center\", \"mb-3\"], [1, \"form-group\", \"mb-3\"], [1, \"fas\", \"fa-file-upload\", \"fa-2x\", \"text-primary\", \"mb-3\"], [\"type\", \"file\", \"id\", \"fileInput\", 1, \"form-control-file\", \"d-none\", 3, \"change\"], [\"for\", \"fileInput\", 1, \"btn\", \"btn-outline-primary\", \"btn-lg\"], [1, \"fas\", \"fa-folder-open\", \"me-2\"], [\"class\", \"selected-file-info\", 4, \"ngIf\"], [1, \"text-center\"], [1, \"btn\", \"btn-primary\", \"btn-lg\", \"px-4\", 3, \"disabled\", \"click\"], [1, \"fas\", \"fa-cloud-upload-alt\", \"me-2\"], [1, \"card\", \"shadow-sm\", \"border-0\"], [1, \"card-header\", \"bg-white\", \"border-bottom\"], [1, \"d-flex\", \"justify-content-between\", \"align-items-center\"], [1, \"fas\", \"fa-database\", \"me-2\", \"text-info\"], [1, \"btn\", \"btn-outline-secondary\", \"btn-sm\", 3, \"click\"], [1, \"fas\", \"fa-sort\", \"me-1\"], [1, \"card-body\", \"p-0\"], [1, \"table-responsive\"], [1, \"table\", \"table-hover\", \"mb-0\"], [1, \"table-light\"], [1, \"border-0\"], [1, \"fas\", \"fa-file\", \"me-1\"], [1, \"fas\", \"fa-fingerprint\", \"me-1\"], [1, \"fas\", \"fa-hdd\", \"me-1\"], [1, \"fas\", \"fa-calendar\", \"me-1\"], [1, \"text-muted\", \"small\"], [1, \"border-0\", \"text-center\"], [1, \"fas\", \"fa-cogs\", \"me-1\"], [\"class\", \"align-middle\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"text-center py-5\", 4, \"ngIf\"], [1, \"card\", \"shadow-sm\", \"mt-4\", \"border-0\"], [1, \"card-header\", \"bg-gradient-success\", \"text-white\"], [1, \"fas\", \"fa-clock\", \"me-2\"], [\"class\", \"text-center py-4\", 4, \"ngIf\"], [1, \"card-header\", \"bg-gradient-info\", \"text-white\"], [1, \"fas\", \"fa-code\", \"me-2\"], [1, \"selected-file-info\"], [1, \"mb-2\"], [1, \"align-middle\"], [1, \"d-flex\", \"align-items-center\"], [1, \"fas\", \"fa-file-alt\", \"text-primary\", \"me-2\"], [1, \"fw-medium\"], [1, \"badge\", \"bg-light\", \"text-dark\"], [1, \"text-muted\"], [\"role\", \"group\", 1, \"btn-group\", \"btn-group-sm\"], [\"title\", \"Download\", 1, \"btn\", \"btn-success\", \"btn-sm\", 3, \"click\"], [1, \"fas\", \"fa-download\"], [\"title\", \"Delete\", 1, \"btn\", \"btn-danger\", \"btn-sm\", 3, \"click\"], [1, \"fas\", \"fa-trash\"], [1, \"text-center\", \"py-5\"], [1, \"fas\", \"fa-folder-open\", \"fa-3x\", \"text-muted\", \"mb-3\"], [1, \"text-muted\", \"h5\"], [1, \"fas\", \"fa-file-alt\", \"text-success\", \"me-2\"], [1, \"badge\", \"bg-success\", \"ms-2\"], [1, \"text-center\", \"py-4\"], [1, \"fas\", \"fa-clock\", \"fa-2x\", \"text-muted\", \"mb-3\"], [1, \"fas\", \"fa-file\", \"text-info\", \"me-2\"]],\n  template: function AppComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"body\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h1\", 3);\n      i0.ɵɵelement(4, \"i\", 4);\n      i0.ɵɵtext(5, \" GCP Storage File Management \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"p\", 5);\n      i0.ɵɵtext(7, \"Securely manage your files in Google Cloud Storage\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(8, \"div\", 6)(9, \"div\", 7)(10, \"h5\", 8);\n      i0.ɵɵelement(11, \"i\", 9);\n      i0.ɵɵtext(12, \" Upload New File \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(13, \"div\", 10)(14, \"div\", 11)(15, \"div\", 12);\n      i0.ɵɵelement(16, \"i\", 13);\n      i0.ɵɵelementStart(17, \"input\", 14);\n      i0.ɵɵlistener(\"change\", function AppComponent_Template_input_change_17_listener($event) {\n        return ctx.onFileSelected($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"label\", 15);\n      i0.ɵɵelement(19, \"i\", 16);\n      i0.ɵɵtext(20, \" Choose File \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(21, AppComponent_div_21_Template, 7, 2, \"div\", 17);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(22, \"div\", 18)(23, \"button\", 19);\n      i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_23_listener() {\n        return ctx.onUpload();\n      });\n      i0.ɵɵelement(24, \"i\", 20);\n      i0.ɵɵtext(25, \" Upload to GCP Storage \");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(26, \"div\", 21)(27, \"div\", 22)(28, \"div\", 23)(29, \"h5\", 8);\n      i0.ɵɵelement(30, \"i\", 24);\n      i0.ɵɵtext(31, \" All Files with Original Names \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"button\", 25);\n      i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_32_listener() {\n        return ctx.toggleSortOrder();\n      });\n      i0.ɵɵelement(33, \"i\", 26);\n      i0.ɵɵtext(34);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(35, \"div\", 27)(36, \"div\", 28)(37, \"table\", 29)(38, \"thead\", 30)(39, \"tr\")(40, \"th\", 31);\n      i0.ɵɵelement(41, \"i\", 32);\n      i0.ɵɵtext(42, \" Original File Name \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(43, \"th\", 31);\n      i0.ɵɵelement(44, \"i\", 33);\n      i0.ɵɵtext(45, \" UUID File Name \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(46, \"th\", 31);\n      i0.ɵɵelement(47, \"i\", 34);\n      i0.ɵɵtext(48, \" Size \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(49, \"th\", 31);\n      i0.ɵɵelement(50, \"i\", 35);\n      i0.ɵɵtext(51, \" Upload Date \");\n      i0.ɵɵelementStart(52, \"span\", 36);\n      i0.ɵɵtext(53);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(54, \"th\", 37);\n      i0.ɵɵelement(55, \"i\", 38);\n      i0.ɵɵtext(56, \" Actions \");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(57, \"tbody\");\n      i0.ɵɵtemplate(58, AppComponent_tr_58_Template, 23, 9, \"tr\", 39);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵtemplate(59, AppComponent_div_59_Template, 6, 0, \"div\", 40);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(60, \"div\", 41)(61, \"div\", 42)(62, \"h5\", 8);\n      i0.ɵɵelement(63, \"i\", 43);\n      i0.ɵɵtext(64, \" Recently Uploaded Files (This Session) \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(65, \"div\", 27)(66, \"div\", 28)(67, \"table\", 29)(68, \"thead\", 30)(69, \"tr\")(70, \"th\", 31);\n      i0.ɵɵelement(71, \"i\", 32);\n      i0.ɵɵtext(72, \" Original File Name \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(73, \"th\", 31);\n      i0.ɵɵelement(74, \"i\", 33);\n      i0.ɵɵtext(75, \" UUID File Name \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(76, \"th\", 37);\n      i0.ɵɵelement(77, \"i\", 38);\n      i0.ɵɵtext(78, \" Actions \");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(79, \"tbody\");\n      i0.ɵɵtemplate(80, AppComponent_tr_80_Template, 17, 2, \"tr\", 39);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵtemplate(81, AppComponent_div_81_Template, 4, 0, \"div\", 44);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(82, \"div\", 41)(83, \"div\", 45)(84, \"h5\", 8);\n      i0.ɵɵelement(85, \"i\", 46);\n      i0.ɵɵtext(86, \" Raw Storage API Response \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(87, \"div\", 27)(88, \"div\", 28)(89, \"table\", 29)(90, \"thead\", 30)(91, \"tr\")(92, \"th\", 31);\n      i0.ɵɵelement(93, \"i\", 33);\n      i0.ɵɵtext(94, \" File Name (UUID) \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(95, \"th\", 37);\n      i0.ɵɵelement(96, \"i\", 38);\n      i0.ɵɵtext(97, \" Actions \");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(98, \"tbody\");\n      i0.ɵɵtemplate(99, AppComponent_tr_99_Template, 12, 1, \"tr\", 39);\n      i0.ɵɵelementEnd()()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(14);\n      i0.ɵɵclassProp(\"bg-light\", !ctx.selectedFile)(\"bg-success-light\", ctx.selectedFile);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngIf\", ctx.selectedFile);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"disabled\", !ctx.selectedFile);\n      i0.ɵɵadvance(11);\n      i0.ɵɵtextInterpolate1(\" Sort by Date: \", ctx.sortDescending ? \"Newest First\" : \"Oldest First\", \" \");\n      i0.ɵɵadvance(19);\n      i0.ɵɵtextInterpolate1(\" \", ctx.sortDescending ? \"(\\u2193 Newest First)\" : \"(\\u2191 Oldest First)\", \" \");\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngForOf\", ctx.filesWithMetadata);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.filesWithMetadata.length === 0);\n      i0.ɵɵadvance(21);\n      i0.ɵɵproperty(\"ngForOf\", ctx.uploadedFiles);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.uploadedFiles.length === 0);\n      i0.ɵɵadvance(18);\n      i0.ɵɵproperty(\"ngForOf\", ctx.files);\n    }\n  },\n  dependencies: [i2.NgForOf, i2.NgIf, i2.DecimalPipe, i2.DatePipe],\n  encapsulation: 2\n});","map":{"version":3,"mappings":";;;;;IA+BUA,+BAAqD;IAC3BA,8BAAc;IAAAA,iBAAS;IAACA,YAAuB;IAAAA,iBAAI;IAC3EA,6BAA4B;IAAAA,YAA2D;IAAAA,iBAAI;;;;IAD3CA,eAAuB;IAAvBA,wDAAuB;IAC3CA,eAA2D;IAA3DA,2FAA2D;;;;;;IA2DrFA,8BAAgE;IAG1DA,wBAAiD;IACjDA,gCAAwB;IAAAA,YAA2B;IAAAA,iBAAO;IAG9DA,0BAAI;IAC6BA,YAAuB;IAAAA,iBAAO;IAE/DA,0BAAI;IACqCA,aAA8B;;IAAAA,iBAAO;IAE9EA,2BAAI;IACwBA,aAAoC;;IAAAA,iBAAQ;IAExEA,+BAAwB;IAEZA;MAAA;MAAA;MAAA;MAAA,OAASA,wDAA+B;IAAA,EAAC;IAG/CA,yBAA+B;IACjCA,iBAAS;IACTA,mCAEuB;IAFfA;MAAA;MAAA;MAAA;MAAA,OAASA,sDAA6B;IAAA,EAAC;IAG7CA,yBAA4B;IAC9BA,iBAAS;;;;IAvBeA,eAA2B;IAA3BA,8CAA2B;IAItBA,eAAuB;IAAvBA,0CAAuB;IAGfA,eAA8B;IAA9BA,wEAA8B;IAG3CA,eAAoC;IAApCA,wEAAoC;;;;;IAqBxEA,+BAAqE;IACnEA,wBAAwD;IACxDA,6BAAyB;IAAAA,yCAAyB;IAAAA,iBAAI;IACtDA,6BAAsB;IAAAA,sDAAsC;IAAAA,iBAAI;;;;;;IAiC5DA,8BAA4D;IAGtDA,wBAAiD;IACjDA,gCAAwB;IAAAA,YAA2B;IAAAA,iBAAO;IAC1DA,gCAAoC;IAAAA,mBAAG;IAAAA,iBAAO;IAGlDA,0BAAI;IAC6BA,aAAuB;IAAAA,iBAAO;IAE/DA,+BAAwB;IAEZA;MAAA;MAAA;MAAA;MAAA,OAASA,0DAA+B;IAAA,EAAC;IAG/CA,yBAA+B;IACjCA,iBAAS;IACTA,mCAEuB;IAFfA;MAAA;MAAA;MAAA;MAAA,OAASA,wDAA6B;IAAA,EAAC;IAG7CA,yBAA4B;IAC9BA,iBAAS;;;;IAlBeA,eAA2B;IAA3BA,+CAA2B;IAKtBA,eAAuB;IAAvBA,2CAAuB;;;;;IAqBhEA,+BAAiE;IAC/DA,wBAAkD;IAClDA,6BAAsB;IAAAA,iDAAiC;IAAAA,iBAAI;;;;;;IA6BvDA,8BAAoD;IAG9CA,wBAA0C;IAC1CA,gCAAyB;IAAAA,YAAe;IAAAA,iBAAO;IAGnDA,8BAAwB;IAEZA;MAAA;MAAA;MAAA;MAAA,OAASA,kDAAuB;IAAA,EAAC;IAGvCA,wBAA+B;IACjCA,iBAAS;IACTA,mCAEuB;IAFfA;MAAA;MAAA;MAAA;MAAA,OAASA,gDAAqB;IAAA,EAAC;IAGrCA,yBAA4B;IAC9BA,iBAAS;;;;IAdgBA,eAAe;IAAfA,mCAAe;;;AC7N5D,OAAM,MAAOC,YAAY;EAavBC,YAAoBC,cAA8B;IAA9B,mBAAc,GAAdA,cAAc;IAZlC,UAAK,GAAG,KAAK;IACb,UAAK,GAAU,EAAE;IACjB,sBAAiB,GAAmB,EAAE,CAAC,CAAC;IACxC,iBAAY,GAAgB,IAAI;IAChC,kBAAa,GAAyD,EAAE,CAAC,CAAC;IAC1E,mBAAc,GAAY,IAAI,CAAC,CAAC;IAEhC;IACA,gBAAW,GAAY,KAAK;IAC5B,mBAAc,GAAW,CAAC;IAC1B,cAAS,GAAY,KAAK;EAE4B;EAEtDC,QAAQ;IACN,IAAI,CAACC,SAAS,EAAE;EAClB;EAEAA,SAAS;IACP,IAAI,CAACC,SAAS,GAAG,IAAI;IAErB;IACA,IAAI,CAACH,cAAc,CAACI,WAAW,EAAE,CAACC,SAAS,CAACC,IAAI,IAAG;MACjD,IAAI,CAACC,KAAK,GAAGD,IAAI,CAACE,KAAK,IAAI,EAAE;IAC/B,CAAC,CAAC;IAEF;IACA,IAAI,CAACR,cAAc,CAACS,uBAAuB,EAAE,CAACJ,SAAS,CAACC,IAAI,IAAG;MAC7D,IAAI,CAACI,iBAAiB,GAAGJ,IAAI;MAC7B,IAAI,CAACK,eAAe,EAAE;MACtB,IAAI,CAACR,SAAS,GAAG,KAAK;IACxB,CAAC,CAAC;EACJ;EAEAQ,eAAe;IACb,IAAI,CAACD,iBAAiB,CAACE,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAI;MACnC,MAAMC,KAAK,GAAG,IAAIC,IAAI,CAACH,CAAC,CAACI,UAAU,CAAC,CAACC,OAAO,EAAE;MAC9C,MAAMC,KAAK,GAAG,IAAIH,IAAI,CAACF,CAAC,CAACG,UAAU,CAAC,CAACC,OAAO,EAAE;MAC9C,OAAO,IAAI,CAACE,cAAc,GAAID,KAAK,GAAGJ,KAAK,GAAKA,KAAK,GAAGI,KAAM;IAChE,CAAC,CAAC;EACJ;EAEAE,eAAe;IACb,IAAI,CAACD,cAAc,GAAG,CAAC,IAAI,CAACA,cAAc;IAC1C,IAAI,CAACT,eAAe,EAAE;EACxB;EAAEW,cAAc,CAACC,KAAU;IACzB,IAAI,CAACC,YAAY,GAAGD,KAAK,CAACE,MAAM,CAAClB,KAAK,CAAC,CAAC,CAAC;EAC3C;EAEAmB,QAAQ;IACN,IAAI,IAAI,CAACF,YAAY,EAAE;MACrB,IAAI,CAACG,WAAW,GAAG,IAAI;MACvB,IAAI,CAAC3B,cAAc,CAAC4B,UAAU,CAAC,IAAI,CAACJ,YAAY,CAAC,CAACnB,SAAS,CAAEwB,QAAwB,IAAI;QACvF;QACA,IAAI,CAACC,aAAa,CAACC,IAAI,CAAC;UACtBC,YAAY,EAAEH,QAAQ,CAACG,YAAY;UACnCC,gBAAgB,EAAEJ,QAAQ,CAACI;SAC5B,CAAC;QACF,IAAI,CAAC/B,SAAS,EAAE;QAChB,IAAI,CAACsB,YAAY,GAAG,IAAI;QACxB,IAAI,CAACG,WAAW,GAAG,KAAK;QAExB;QACA,MAAMO,SAAS,GAAGC,QAAQ,CAACC,cAAc,CAAC,WAAW,CAAqB;QAC1E,IAAIF,SAAS,EAAE;UACbA,SAAS,CAACG,KAAK,GAAG,EAAE;;MAExB,CAAC,EAAEC,KAAK,IAAG;QACT,IAAI,CAACX,WAAW,GAAG,KAAK;QACxBY,OAAO,CAACD,KAAK,CAAC,gBAAgB,EAAEA,KAAK,CAAC;MACxC,CAAC,CAAC;;EAEN;EAEAE,YAAY,CAACR,YAAoB;IAC/B;IACA,IAAI,CAAChC,cAAc,CAACwC,YAAY,CAACR,YAAY,CAAC;EAChD;EAEA;EACAS,kBAAkB,CAACT,YAAoB;IACrC,IAAI,CAAChC,cAAc,CAACyC,kBAAkB,CAACT,YAAY,CAAC,CAAC3B,SAAS,CAAEqC,IAAU,IAAI;MAC5E,MAAM7B,CAAC,GAAGsB,QAAQ,CAACQ,aAAa,CAAC,GAAG,CAAC;MACrC,MAAMC,SAAS,GAAGC,GAAG,CAACC,eAAe,CAACJ,IAAI,CAAC;MAC3C7B,CAAC,CAACkC,IAAI,GAAGH,SAAS;MAClB/B,CAAC,CAACmC,QAAQ,GAAG,cAAchB,YAAY,EAAE,CAAC,CAAC;MAC3CnB,CAAC,CAACoC,KAAK,EAAE;MACTJ,GAAG,CAACK,eAAe,CAACN,SAAS,CAAC;IAChC,CAAC,CAAC;EACJ;EAEAO,UAAU,CAACnB,YAAoB;IAC7B,IAAI,CAAChC,cAAc,CAACmD,UAAU,CAACnB,YAAY,CAAC,CAAC3B,SAAS,CAAC,MAAK;MAC1D;MACA,IAAI,CAACyB,aAAa,GAAG,IAAI,CAACA,aAAa,CAACsB,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACrB,YAAY,KAAKA,YAAY,CAAC;MACpF,IAAI,CAAC9B,SAAS,EAAE;IAClB,CAAC,CAAC;EACJ;;AAlGWJ,YAAY;mBAAZA,YAAY;AAAA;AAAZA,YAAY;QAAZA,YAAY;EAAAwD;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MDPzB7D,+BAAuB;MAKfA,uBAA4C;MAC5CA,6CACF;MAAAA,iBAAK;MACLA,4BAA2B;MAAAA,kEAAkD;MAAAA,iBAAI;MAInFA,8BAA0C;MAGpCA,wBAAkC;MAClCA,kCACF;MAAAA,iBAAK;MAEPA,gCAA2B;MAKrBA,yBAA0D;MAC1DA,kCAAqG;MAAlFA;QAAA,OAAU8D,0BAAsB;MAAA,EAAC;MAApD9D,iBAAqG;MACrGA,kCAA8D;MAC5DA,yBAAuC;MACvCA,8BACF;MAAAA,iBAAQ;MAEVA,gEAGM;MACRA,iBAAM;MACNA,gCAAyB;MACfA;QAAA,OAAS8D,cAAU;MAAA,EAAC;MAG1B9D,yBAA4C;MAC5CA,wCACF;MAAAA,iBAAS;MAMfA,gCAAqC;MAI7BA,yBAA8C;MAC9CA,gDACF;MAAAA,iBAAK;MACLA,mCAA6E;MAArEA;QAAA,OAAS8D,qBAAiB;MAAA,EAAC;MACjC9D,yBAAgC;MAChCA,aACF;MAAAA,iBAAS;MAGbA,gCAA2B;MAMfA,yBAAgC;MAChCA,qCACF;MAAAA,iBAAK;MACLA,+BAAqB;MACnBA,yBAAuC;MACvCA,iCACF;MAAAA,iBAAK;MACLA,+BAAqB;MACnBA,yBAA+B;MAC/BA,uBACF;MAAAA,iBAAK;MACLA,+BAAqB;MACnBA,yBAAoC;MACpCA,8BACA;MAAAA,iCAA+B;MAC7BA,aACF;MAAAA,iBAAO;MAETA,+BAAiC;MAC/BA,yBAAgC;MAChCA,0BACF;MAAAA,iBAAK;MAGTA,8BAAO;MACLA,+DA8BK;MACPA,iBAAQ;MAIZA,gEAIM;MACRA,iBAAM;MAIRA,gCAA0C;MAGpCA,yBAAiC;MACjCA,yDACF;MAAAA,iBAAK;MAEPA,gCAA2B;MAMfA,yBAAgC;MAChCA,qCACF;MAAAA,iBAAK;MACLA,+BAAqB;MACnBA,yBAAuC;MACvCA,iCACF;MAAAA,iBAAK;MACLA,+BAAiC;MAC/BA,yBAAgC;MAChCA,0BACF;MAAAA,iBAAK;MAGTA,8BAAO;MACLA,+DAyBK;MACPA,iBAAQ;MAIZA,gEAGM;MACRA,iBAAM;MAIRA,gCAA0C;MAGpCA,yBAAgC;MAChCA,2CACF;MAAAA,iBAAK;MAEPA,gCAA2B;MAMfA,yBAAuC;MACvCA,mCACF;MAAAA,iBAAK;MACLA,+BAAiC;MAC/BA,yBAAgC;MAChCA,0BACF;MAAAA,iBAAK;MAGTA,8BAAO;MACLA,+DAqBK;MACPA,iBAAQ;;;MAjOPA,gBAAgC;MAAhCA,6CAAgC;MAU7BA,eAAkB;MAAlBA,uCAAkB;MAQhBA,eAA0B;MAA1BA,4CAA0B;MAkBhCA,gBACF;MADEA,mGACF;MAwBUA,gBACF;MADEA,uGACF;MASiBA,eAAoB;MAApBA,+CAAoB;MAmCzCA,eAAoC;MAApCA,yDAAoC;MAoCfA,gBAAgB;MAAhBA,2CAAgB;MA8BrCA,eAAgC;MAAhCA,qDAAgC;MA+BXA,gBAAQ;MAARA,mCAAQ","names":["i0","AppComponent","constructor","storageService","ngOnInit","loadFiles","isLoading","getFileList","subscribe","data","files","items","getFileListWithMetadata","filesWithMetadata","sortFilesByDate","sort","a","b","dateA","Date","uploadDate","getTime","dateB","sortDescending","toggleSortOrder","onFileSelected","event","selectedFile","target","onUpload","isUploading","uploadFile","response","uploadedFiles","push","uuidFileName","originalFileName","fileInput","document","getElementById","value","error","console","downloadFile","downloadFileAsBlob","blob","createElement","objectUrl","URL","createObjectURL","href","download","click","revokeObjectURL","deleteFile","filter","f","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/Users/delllin/Projects/GcpFileMove/ClientApp/src/app/app.component.html","/Users/delllin/Projects/GcpFileMove/ClientApp/src/app/app.component.ts"],"sourcesContent":["<body class=\"bg-light\">\n  <div class=\"container py-4\">\n    <!-- Header Section -->\n    <div class=\"text-center mb-5\">\n      <h1 class=\"display-4 text-primary mb-2\">\n        <i class=\"fas fa-cloud-upload-alt me-3\"></i>\n        GCP Storage File Management\n      </h1>\n      <p class=\"lead text-muted\">Securely manage your files in Google Cloud Storage</p>\n    </div>\n\n    <!-- Upload Section -->\n    <div class=\"card shadow-sm mb-4 border-0\">\n      <div class=\"card-header bg-gradient-primary text-white\">\n        <h5 class=\"card-title mb-0\">\n          <i class=\"fas fa-upload me-2\"></i>\n          Upload New File\n        </h5>\n      </div>\n      <div class=\"card-body p-4\">\n        <div class=\"upload-area border-2 border-dashed border-primary rounded p-4 text-center mb-3\" \n             [class.bg-light]=\"!selectedFile\" \n             [class.bg-success-light]=\"selectedFile\">\n          <div class=\"form-group mb-3\">\n            <i class=\"fas fa-file-upload fa-2x text-primary mb-3\"></i>\n            <input type=\"file\" (change)=\"onFileSelected($event)\" class=\"form-control-file d-none\" id=\"fileInput\">\n            <label for=\"fileInput\" class=\"btn btn-outline-primary btn-lg\">\n              <i class=\"fas fa-folder-open me-2\"></i>\n              Choose File\n            </label>\n          </div>\n          <div *ngIf=\"selectedFile\" class=\"selected-file-info\">\n            <p class=\"mb-2\"><strong>Selected File:</strong> {{ selectedFile.name }}</p>\n            <p class=\"text-muted small\">Size: {{ (selectedFile.size / 1024 / 1024).toFixed(2) }} MB</p>\n          </div>\n        </div>\n        <div class=\"text-center\">\n          <button (click)=\"onUpload()\" \n                  class=\"btn btn-primary btn-lg px-4\" \n                  [disabled]=\"!selectedFile\">\n            <i class=\"fas fa-cloud-upload-alt me-2\"></i>\n            Upload to GCP Storage\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- All Files Section -->\n    <div class=\"card shadow-sm border-0\">\n      <div class=\"card-header bg-white border-bottom\">\n        <div class=\"d-flex justify-content-between align-items-center\">\n          <h5 class=\"card-title mb-0\">\n            <i class=\"fas fa-database me-2 text-info\"></i>\n            All Files with Original Names\n          </h5>\n          <button (click)=\"toggleSortOrder()\" class=\"btn btn-outline-secondary btn-sm\">\n            <i class=\"fas fa-sort me-1\"></i>\n            Sort by Date: {{ sortDescending ? 'Newest First' : 'Oldest First' }}\n          </button>\n        </div>\n      </div>\n      <div class=\"card-body p-0\">\n        <div class=\"table-responsive\">\n          <table class=\"table table-hover mb-0\">\n            <thead class=\"table-light\">\n              <tr>\n                <th class=\"border-0\">\n                  <i class=\"fas fa-file me-1\"></i>\n                  Original File Name\n                </th>\n                <th class=\"border-0\">\n                  <i class=\"fas fa-fingerprint me-1\"></i>\n                  UUID File Name\n                </th>\n                <th class=\"border-0\">\n                  <i class=\"fas fa-hdd me-1\"></i>\n                  Size\n                </th>\n                <th class=\"border-0\">\n                  <i class=\"fas fa-calendar me-1\"></i>\n                  Upload Date\n                  <span class=\"text-muted small\">\n                    {{ sortDescending ? '(↓ Newest First)' : '(↑ Oldest First)' }}\n                  </span>\n                </th>\n                <th class=\"border-0 text-center\">\n                  <i class=\"fas fa-cogs me-1\"></i>\n                  Actions\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr *ngFor=\"let file of filesWithMetadata\" class=\"align-middle\">\n                <td>\n                  <div class=\"d-flex align-items-center\">\n                    <i class=\"fas fa-file-alt text-primary me-2\"></i>\n                    <span class=\"fw-medium\">{{ file.originalFileName }}</span>\n                  </div>\n                </td>\n                <td>\n                  <code class=\"text-muted small\">{{ file.uuidFileName }}</code>\n                </td>\n                <td>\n                  <span class=\"badge bg-light text-dark\">{{ file.size | number }} bytes</span>\n                </td>\n                <td>\n                  <small class=\"text-muted\">{{ file.uploadDate | date:'short' }}</small>\n                </td>\n                <td class=\"text-center\">\n                  <div class=\"btn-group btn-group-sm\" role=\"group\">\n                    <button (click)=\"downloadFile(file.uuidFileName)\" \n                            class=\"btn btn-success btn-sm\" \n                            title=\"Download\">\n                      <i class=\"fas fa-download\"></i>\n                    </button>\n                    <button (click)=\"deleteFile(file.uuidFileName)\" \n                            class=\"btn btn-danger btn-sm\" \n                            title=\"Delete\">\n                      <i class=\"fas fa-trash\"></i>\n                    </button>\n                  </div>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n\n        <div *ngIf=\"filesWithMetadata.length === 0\" class=\"text-center py-5\">\n          <i class=\"fas fa-folder-open fa-3x text-muted mb-3\"></i>\n          <p class=\"text-muted h5\">No files found in storage</p>\n          <p class=\"text-muted\">Upload your first file to get started!</p>\n        </div>\n      </div>\n    </div>\n\n    <!-- Recent Uploads Section -->\n    <div class=\"card shadow-sm mt-4 border-0\">\n      <div class=\"card-header bg-gradient-success text-white\">\n        <h5 class=\"card-title mb-0\">\n          <i class=\"fas fa-clock me-2\"></i>\n          Recently Uploaded Files (This Session)\n        </h5>\n      </div>\n      <div class=\"card-body p-0\">\n        <div class=\"table-responsive\">\n          <table class=\"table table-hover mb-0\">\n            <thead class=\"table-light\">\n              <tr>\n                <th class=\"border-0\">\n                  <i class=\"fas fa-file me-1\"></i>\n                  Original File Name\n                </th>\n                <th class=\"border-0\">\n                  <i class=\"fas fa-fingerprint me-1\"></i>\n                  UUID File Name\n                </th>\n                <th class=\"border-0 text-center\">\n                  <i class=\"fas fa-cogs me-1\"></i>\n                  Actions\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr *ngFor=\"let file of uploadedFiles\" class=\"align-middle\">\n                <td>\n                  <div class=\"d-flex align-items-center\">\n                    <i class=\"fas fa-file-alt text-success me-2\"></i>\n                    <span class=\"fw-medium\">{{ file.originalFileName }}</span>\n                    <span class=\"badge bg-success ms-2\">New</span>\n                  </div>\n                </td>\n                <td>\n                  <code class=\"text-muted small\">{{ file.uuidFileName }}</code>\n                </td>\n                <td class=\"text-center\">\n                  <div class=\"btn-group btn-group-sm\" role=\"group\">\n                    <button (click)=\"downloadFile(file.uuidFileName)\" \n                            class=\"btn btn-success btn-sm\" \n                            title=\"Download\">\n                      <i class=\"fas fa-download\"></i>\n                    </button>\n                    <button (click)=\"deleteFile(file.uuidFileName)\" \n                            class=\"btn btn-danger btn-sm\" \n                            title=\"Delete\">\n                      <i class=\"fas fa-trash\"></i>\n                    </button>\n                  </div>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n\n        <div *ngIf=\"uploadedFiles.length === 0\" class=\"text-center py-4\">\n          <i class=\"fas fa-clock fa-2x text-muted mb-3\"></i>\n          <p class=\"text-muted\">No files uploaded in this session</p>\n        </div>\n      </div>\n    </div>\n\n    <!-- Raw API Response Section -->\n    <div class=\"card shadow-sm mt-4 border-0\">\n      <div class=\"card-header bg-gradient-info text-white\">\n        <h5 class=\"card-title mb-0\">\n          <i class=\"fas fa-code me-2\"></i>\n          Raw Storage API Response\n        </h5>\n      </div>\n      <div class=\"card-body p-0\">\n        <div class=\"table-responsive\">\n          <table class=\"table table-hover mb-0\">\n            <thead class=\"table-light\">\n              <tr>\n                <th class=\"border-0\">\n                  <i class=\"fas fa-fingerprint me-1\"></i>\n                  File Name (UUID)\n                </th>\n                <th class=\"border-0 text-center\">\n                  <i class=\"fas fa-cogs me-1\"></i>\n                  Actions\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr *ngFor=\"let file of files\" class=\"align-middle\">\n                <td>\n                  <div class=\"d-flex align-items-center\">\n                    <i class=\"fas fa-file text-info me-2\"></i>\n                    <code class=\"text-muted\">{{ file.name }}</code>\n                  </div>\n                </td>\n                <td class=\"text-center\">\n                  <div class=\"btn-group btn-group-sm\" role=\"group\">\n                    <button (click)=\"downloadFile(file.name)\" \n                            class=\"btn btn-success btn-sm\" \n                            title=\"Download\">\n                      <i class=\"fas fa-download\"></i>\n                    </button>\n                    <button (click)=\"deleteFile(file.name)\" \n                            class=\"btn btn-danger btn-sm\" \n                            title=\"Delete\">\n                      <i class=\"fas fa-trash\"></i>\n                    </button>\n                  </div>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</body>","import { Component, OnInit } from '@angular/core';\nimport { StorageService, UploadResponse, FileMetadata } from './storage.service';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html'\n})\nexport class AppComponent implements OnInit {\n  title = 'app';\n  files: any[] = [];\n  filesWithMetadata: FileMetadata[] = []; // 帶有原始檔案名稱的檔案列表\n  selectedFile: File | null = null;\n  uploadedFiles: { uuidFileName: string, originalFileName: string }[] = []; // 儲存上傳的檔案資訊\n  sortDescending: boolean = true; // 排序方向：true = 降序（最新在前），false = 升序（最舊在前）\n  \n  // UI state management\n  isUploading: boolean = false;\n  uploadProgress: number = 0;\n  isLoading: boolean = false;\n\n  constructor(private storageService: StorageService) { }\n\n  ngOnInit() {\n    this.loadFiles();\n  }\n\n  loadFiles() {\n    this.isLoading = true;\n    \n    // 載入原始的檔案列表（舊版 API）\n    this.storageService.getFileList().subscribe(data => {\n      this.files = data.items || [];\n    });\n\n    // 載入帶有元數據的檔案列表（新版 API）\n    this.storageService.getFileListWithMetadata().subscribe(data => {\n      this.filesWithMetadata = data;\n      this.sortFilesByDate();\n      this.isLoading = false;\n    });\n  }\n\n  sortFilesByDate() {\n    this.filesWithMetadata.sort((a, b) => {\n      const dateA = new Date(a.uploadDate).getTime();\n      const dateB = new Date(b.uploadDate).getTime();\n      return this.sortDescending ? (dateB - dateA) : (dateA - dateB);\n    });\n  }\n\n  toggleSortOrder() {\n    this.sortDescending = !this.sortDescending;\n    this.sortFilesByDate();\n  } onFileSelected(event: any) {\n    this.selectedFile = event.target.files[0];\n  }\n\n  onUpload() {\n    if (this.selectedFile) {\n      this.isUploading = true;\n      this.storageService.uploadFile(this.selectedFile).subscribe((response: UploadResponse) => {\n        // 將上傳的檔案資訊加入到列表中\n        this.uploadedFiles.push({\n          uuidFileName: response.uuidFileName,\n          originalFileName: response.originalFileName\n        });\n        this.loadFiles();\n        this.selectedFile = null;\n        this.isUploading = false;\n        \n        // Reset file input\n        const fileInput = document.getElementById('fileInput') as HTMLInputElement;\n        if (fileInput) {\n          fileInput.value = '';\n        }\n      }, error => {\n        this.isUploading = false;\n        console.error('Upload failed:', error);\n      });\n    }\n  }\n\n  downloadFile(uuidFileName: string) {\n    // 使用簡化的下載方法，直接開啟下載連結\n    this.storageService.downloadFile(uuidFileName);\n  }\n\n  // 如果需要更複雜的下載處理，可以使用這個方法\n  downloadFileAsBlob(uuidFileName: string) {\n    this.storageService.downloadFileAsBlob(uuidFileName).subscribe((blob: Blob) => {\n      const a = document.createElement('a');\n      const objectUrl = URL.createObjectURL(blob);\n      a.href = objectUrl;\n      a.download = `downloaded_${uuidFileName}`; // 使用 UUID 作為預設檔案名稱\n      a.click();\n      URL.revokeObjectURL(objectUrl);\n    });\n  }\n\n  deleteFile(uuidFileName: string) {\n    this.storageService.deleteFile(uuidFileName).subscribe(() => {\n      // 從本地列表中移除已刪除的檔案\n      this.uploadedFiles = this.uploadedFiles.filter(f => f.uuidFileName !== uuidFileName);\n      this.loadFiles();\n    });\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}